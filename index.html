<!DOCTYPE html>
<html>
<head>
   <title>Network Visualization - Highlighted Nodes</title>
   <style>
       body { 
           margin: 0; 
           background: #ffffff;
           font-family: Arial, sans-serif;
       }
       canvas { 
           width: 100vw; 
           height: 100vh; 
       }
       .node-label {
           color: black;
           background: rgba(255,255,255,0.9);
           padding: 8px;
           border-radius: 4px;
           border: 1px solid rgba(0,0,0,0.2);
           font-size: 12px;
           pointer-events: none;
           position: absolute;
           display: none;
           font-family: monospace;
       }
       .legend {
           position: fixed;
           top: 20px;
           left: 20px;
           background: white;
           padding: 10px;
           border-radius: 4px;
           border: 1px solid rgba(0,0,0,0.2);
           font-size: 12px;
       }
       .legend-item {
           margin: 5px 0;
           display: flex;
           align-items: center;
       }
       .color-box {
           width: 20px;
           height: 20px;
           margin-right: 10px;
           border: 1px solid rgba(0,0,0,0.2);
       }
   </style>
   <script src="https://unpkg.com/3d-force-graph"></script>
</head>
<body>
   <div id="3d-graph"></div>
   <div id="node-info" class="node-label"></div>
   <div class="legend">
       <div class="legend-item">
           <div class="color-box" style="background: #FF6B6B;"></div>
           <div>currentglobalnews.site</div>
       </div>
       <div class="legend-item">
           <div class="color-box" style="background: #4ECDC4;"></div>
           <div>Barrie Location</div>
       </div>
       <div class="legend-item">
           <div class="color-box" style="background: #45B7D1;"></div>
           <div>Amsterdam Location</div>
       </div>
       <div class="legend-item">
           <div class="color-box" style="background: #96CEB4;"></div>
           <div>beget.com</div>
       </div>
   </div>

   <script>
       console.log('Starting to fetch network data...');
       fetch('./network_data.json')
           .then(response => {
               console.log('Response received:', response);
               if (!response.ok) {
                   throw new Error(`HTTP error! status: ${response.status}`);
               }
               return response.json();
           })
           .then(graphData => {
               console.log('Data loaded successfully:', graphData);
               const nodeInfo = document.getElementById('node-info');
               
               const highlightedNodes = {
                   'currentglobalnews.site': '#FF6B6B',
                   '276 Tiffin St, Barrie, ON, L4N-2N4, CA': '#4ECDC4',
                   'Amsterdam, North Holland, NH, The Netherlands, NL': '#45B7D1',
                   'beget.com': '#96CEB4'
               };
               
               const Graph = ForceGraph3D()
                   (document.getElementById('3d-graph'))
                   .graphData(graphData)
                   .linkColor(() => 'rgba(0,0,0,0.2)')
                   .linkWidth(1)
                   .linkDirectionalArrowLength(3.5)
                   .nodeColor(node => {
                       return highlightedNodes[node.id] || 'rgba(200,200,200,0.2)';
                   })
                   .nodeRelSize(node => {
                       return highlightedNodes[node.id] ? 8 : 4;
                   })
                   .backgroundColor('#ffffff')
                   .onNodeHover(node => {
                       if (node) {
                           nodeInfo.innerHTML = `<strong>${node.id}</strong><br><small>Type: ${node.type || 'Unknown'}</small>`;
                           nodeInfo.style.display = 'block';
                           
                           document.addEventListener('mousemove', moveLabel);
                       } else {
                           nodeInfo.style.display = 'none';
                           document.removeEventListener('mousemove', moveLabel);
                       }
                   });

               // Center view on highlighted nodes
               Graph.cameraPosition(
                   { x: 100, y: 100, z: 300 }, // new position
                   { x: 0, y: 0, z: 0 }, // lookAt
                   3000  // transition duration
               );
           })
           .catch(error => {
               console.error('Error loading the graph data:', error);
           });

       function moveLabel(event) {
           nodeInfo.style.left = (event.pageX + 10) + 'px';
           nodeInfo.style.top = (event.pageY + 10) + 'px';
       }
   </script>
</body>
</html>
